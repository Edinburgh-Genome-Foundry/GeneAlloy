


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.5.0">
    
    
      
        <title>Genealloy - GeneAlloy</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.b5d04df8.min.css">
      
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.9ab2c1f8.min.css">
      
      
        
        
        <meta name="theme-color" content="#4caf50">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="green" data-md-color-accent="lightgreen">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#module-genealloygenealloy" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../../.." title="GeneAlloy" class="md-header-nav__button md-logo" aria-label="GeneAlloy">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            GeneAlloy
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Genealloy
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/Edinburgh-Genome-Foundry/GeneAlloy/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GeneAlloy
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="GeneAlloy" class="md-nav__button md-logo" aria-label="GeneAlloy">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    GeneAlloy
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/Edinburgh-Genome-Foundry/GeneAlloy/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GeneAlloy
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Reference
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Reference" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Reference
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-1" type="checkbox" id="nav-2-1" checked>
    
    <label class="md-nav__link" for="nav-2-1">
      Genealloy
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Genealloy" data-md-level="2">
      <label class="md-nav__title" for="nav-2-1">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Genealloy
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../codontable/" title="Codontable" class="md-nav__link">
      Codontable
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Genealloy
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg>
        </span>
      </label>
    
    <a href="./" title="Genealloy" class="md-nav__link md-nav__link--active">
      Genealloy
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#variables" class="md-nav__link">
    Variables
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#compare_sequence_tuplelists" class="md-nav__link">
    compare_sequence_tuplelists
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compare_sequence_tuplelists_in_all_frames" class="md-nav__link">
    compare_sequence_tuplelists_in_all_frames
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compare_then_get_letter_recursively" class="md-nav__link">
    compare_then_get_letter_recursively
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convert_codonlist_to_tuplelist" class="md-nav__link">
    convert_codonlist_to_tuplelist
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convert_seq_to_codons" class="md-nav__link">
    convert_seq_to_codons
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#find_partial_overlaps" class="md-nav__link">
    find_partial_overlaps
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_complement_tuplelist" class="md-nav__link">
    get_complement_tuplelist
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_letter_in_next_triplet" class="md-nav__link">
    get_letter_in_next_triplet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_next_letter" class="md-nav__link">
    get_next_letter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_reverse_complement_tuplelist" class="md-nav__link">
    get_reverse_complement_tuplelist
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_reverse_tuplelist" class="md-nav__link">
    get_reverse_tuplelist
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#make_genealloy" class="md-nav__link">
    make_genealloy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#walk_seqstep" class="md-nav__link">
    walk_seqstep
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#duodon" class="md-nav__link">
    Duodon
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqstep" class="md-nav__link">
    SeqStep
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parameters" class="md-nav__link">
    Parameters
  </a>
  
    <nav class="md-nav" aria-label="Parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#methods" class="md-nav__link">
    Methods
  </a>
  
    <nav class="md-nav" aria-label="Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#advance_step" class="md-nav__link">
    advance_step
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compare_triplet_and_duodon" class="md-nav__link">
    compare_triplet_and_duodon
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generate_duodons" class="md-nav__link">
    generate_duodons
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#return_all_matching_duodons" class="md-nav__link">
    return_all_matching_duodons
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Index" class="md-nav__link">
      Index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../version/" title="Version" class="md-nav__link">
      Version
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#variables" class="md-nav__link">
    Variables
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#compare_sequence_tuplelists" class="md-nav__link">
    compare_sequence_tuplelists
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compare_sequence_tuplelists_in_all_frames" class="md-nav__link">
    compare_sequence_tuplelists_in_all_frames
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compare_then_get_letter_recursively" class="md-nav__link">
    compare_then_get_letter_recursively
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convert_codonlist_to_tuplelist" class="md-nav__link">
    convert_codonlist_to_tuplelist
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convert_seq_to_codons" class="md-nav__link">
    convert_seq_to_codons
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#find_partial_overlaps" class="md-nav__link">
    find_partial_overlaps
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_complement_tuplelist" class="md-nav__link">
    get_complement_tuplelist
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_letter_in_next_triplet" class="md-nav__link">
    get_letter_in_next_triplet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_next_letter" class="md-nav__link">
    get_next_letter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_reverse_complement_tuplelist" class="md-nav__link">
    get_reverse_complement_tuplelist
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_reverse_tuplelist" class="md-nav__link">
    get_reverse_tuplelist
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#make_genealloy" class="md-nav__link">
    make_genealloy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#walk_seqstep" class="md-nav__link">
    walk_seqstep
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#duodon" class="md-nav__link">
    Duodon
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqstep" class="md-nav__link">
    SeqStep
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parameters" class="md-nav__link">
    Parameters
  </a>
  
    <nav class="md-nav" aria-label="Parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#methods" class="md-nav__link">
    Methods
  </a>
  
    <nav class="md-nav" aria-label="Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#advance_step" class="md-nav__link">
    advance_step
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compare_triplet_and_duodon" class="md-nav__link">
    compare_triplet_and_duodon
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generate_duodons" class="md-nav__link">
    generate_duodons
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#return_all_matching_duodons" class="md-nav__link">
    return_all_matching_duodons
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/Edinburgh-Genome-Foundry/GeneAlloy/edit/master/reference/genealloy/genealloy.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                <h1 id="module-genealloygenealloy">Module genealloy.genealloy</h1>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="s s-Atom">from</span> <span class="p">.</span><span class="s s-Atom">codontable</span> <span class="nf">import</span> <span class="p">(</span>

    <span class="s s-Atom">codon_to_aa</span><span class="p">,</span>

    <span class="s s-Atom">aa_to_codon_extended</span><span class="p">,</span>

    <span class="s s-Atom">codon_extended_to_aa</span><span class="p">,</span>

    <span class="s s-Atom">complement_table</span><span class="p">,</span>

    <span class="s s-Atom">compare_letters</span><span class="p">,</span>

<span class="p">)</span>

<span class="s s-Atom">def</span> <span class="nf">convert_seq_to_codons</span><span class="p">(</span><span class="s s-Atom">seq</span><span class="p">)</span><span class="s s-Atom">:</span>

    <span class="s2">&quot;&quot;&quot;Convert a string (sequence) into a list of 3-letter strings (triplets).&quot;&quot;&quot;</span>

    <span class="s s-Atom">seq_codons</span> <span class="o">=</span> <span class="p">[</span><span class="s s-Atom">seq</span><span class="p">[</span><span class="s s-Atom">i</span> <span class="s s-Atom">:</span> <span class="s s-Atom">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="s s-Atom">for</span> <span class="s s-Atom">i</span> <span class="s s-Atom">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nf">len</span><span class="p">(</span><span class="s s-Atom">seq</span><span class="p">),</span> <span class="mi">3</span><span class="p">)]</span>

    <span class="s s-Atom">return</span> <span class="s s-Atom">seq_codons</span>

<span class="s s-Atom">def</span> <span class="nf">convert_codonlist_to_tuplelist</span><span class="p">(</span><span class="s s-Atom">seq_codons</span><span class="p">,</span> <span class="s s-Atom">codon_to_codon_extended</span><span class="p">)</span><span class="s s-Atom">:</span>

    <span class="s2">&quot;&quot;&quot;Convert a list of triplets into a list of tuples, using a swaptable.</span>

<span class="s2">    The swaptable is a dict of triplet: triplets, and determines the</span>

<span class="s2">    allowed swaps.</span>

<span class="s2">    &quot;&quot;&quot;</span>

    <span class="s s-Atom">codon_extended</span> <span class="o">=</span> <span class="p">[</span><span class="nv">None</span><span class="p">]</span> <span class="o">*</span> <span class="nf">len</span><span class="p">(</span><span class="s s-Atom">seq_codons</span><span class="p">)</span>

    <span class="s s-Atom">for</span> <span class="s s-Atom">i</span><span class="p">,</span> <span class="s s-Atom">codon</span> <span class="s s-Atom">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="s s-Atom">seq_codons</span><span class="p">)</span><span class="s s-Atom">:</span>

        <span class="s s-Atom">codon_extended</span><span class="p">[</span><span class="s s-Atom">i</span><span class="p">]</span> <span class="o">=</span> <span class="s s-Atom">codon_to_codon_extended</span><span class="p">[</span><span class="s s-Atom">codon</span><span class="p">]</span>

    <span class="s s-Atom">return</span> <span class="s s-Atom">codon_extended</span>

<span class="s s-Atom">def</span> <span class="nf">get_next_letter</span><span class="p">(</span><span class="s s-Atom">sequence_tuplelist</span><span class="p">,</span> <span class="s s-Atom">current_letter_index</span><span class="p">)</span><span class="s s-Atom">:</span>

    <span class="s2">&quot;&quot;&quot;Get next letter in the sequence.&quot;&quot;&quot;</span>

    <span class="s s-Atom">letter_index</span> <span class="o">=</span> <span class="s s-Atom">current_letter_index</span>

    <span class="s s-Atom">if</span> <span class="s s-Atom">current_letter_index</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="s s-Atom">:</span>

        <span class="s s-Atom">#</span> <span class="s s-Atom">last</span> <span class="s s-Atom">letter</span> <span class="s s-Atom">of</span> <span class="s s-Atom">triplet</span><span class="p">,</span> <span class="s s-Atom">advance</span> <span class="s s-Atom">to</span> <span class="s s-Atom">next</span> <span class="nn">codon</span><span class="p">:</span>

        <span class="s s-Atom">letter_index</span> <span class="o">=</span> <span class="p">[</span><span class="s s-Atom">letter_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

        <span class="nn">try</span><span class="p">:</span>

            <span class="s s-Atom">i</span><span class="p">,</span> <span class="s s-Atom">j</span><span class="p">,</span> <span class="s s-Atom">k</span> <span class="o">=</span> <span class="s s-Atom">letter_index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s s-Atom">letter_index</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s s-Atom">letter_index</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

            <span class="s s-Atom">letter</span> <span class="o">=</span> <span class="p">(</span><span class="s s-Atom">sequence_tuplelist</span><span class="p">[</span><span class="s s-Atom">i</span><span class="p">][</span><span class="s s-Atom">j</span><span class="p">][</span><span class="s s-Atom">k</span><span class="p">],</span> <span class="s s-Atom">letter_index</span><span class="p">)</span>

            <span class="s s-Atom">return</span> <span class="s s-Atom">letter</span>

        <span class="nn">except</span><span class="p">:</span>

            <span class="s s-Atom">raise</span>

    <span class="nn">else</span><span class="p">:</span>

        <span class="s s-Atom">#</span> <span class="s s-Atom">letter</span> <span class="o">is</span> <span class="o">not</span> <span class="s s-Atom">the</span> <span class="s s-Atom">last</span> <span class="s s-Atom">in</span> <span class="s s-Atom">triplet</span><span class="p">,</span> <span class="s s-Atom">get</span> <span class="s s-Atom">the</span> <span class="s s-Atom">next</span> <span class="nn">one</span><span class="p">:</span>

        <span class="s s-Atom">letter_index</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="s s-Atom">letter_index</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="s s-Atom">i</span><span class="p">,</span> <span class="s s-Atom">j</span><span class="p">,</span> <span class="s s-Atom">k</span> <span class="o">=</span> <span class="s s-Atom">letter_index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s s-Atom">letter_index</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s s-Atom">letter_index</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

        <span class="s s-Atom">letter</span> <span class="o">=</span> <span class="p">(</span><span class="s s-Atom">sequence_tuplelist</span><span class="p">[</span><span class="s s-Atom">i</span><span class="p">][</span><span class="s s-Atom">j</span><span class="p">][</span><span class="s s-Atom">k</span><span class="p">],</span> <span class="s s-Atom">letter_index</span><span class="p">)</span>

        <span class="s s-Atom">return</span> <span class="s s-Atom">letter</span>

<span class="s s-Atom">def</span> <span class="nf">get_letter_in_next_triplet</span><span class="p">(</span><span class="s s-Atom">sequence_tuplelist</span><span class="p">,</span> <span class="s s-Atom">current_letter_index</span><span class="p">)</span><span class="s s-Atom">:</span>

    <span class="s2">&quot;&quot;&quot;Get first letter in the next triplet.&quot;&quot;&quot;</span>

    <span class="s s-Atom">letter_index</span> <span class="o">=</span> <span class="s s-Atom">current_letter_index</span>

    <span class="s s-Atom">letter_index</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s s-Atom">letter_index</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>  <span class="s s-Atom">#</span> <span class="s s-Atom">triplet</span> <span class="s s-Atom">position</span>

    <span class="s s-Atom">letter_index</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>  <span class="s s-Atom">#</span> <span class="s s-Atom">move</span> <span class="s s-Atom">letter</span> <span class="s s-Atom">position</span> <span class="s s-Atom">to</span> <span class="s s-Atom">triplet&#39;s first letter</span>

<span class="s s-Atom">    try:</span>

<span class="s s-Atom">        i, j, k = letter_index[0], letter_index[1], letter_index[2]</span>

<span class="s s-Atom">        letter = (sequence_tuplelist[i][j][k], letter_index)</span>

<span class="s s-Atom">        return letter</span>

<span class="s s-Atom">    except:</span>

<span class="s s-Atom">        raise</span>

<span class="s s-Atom">def compare_then_get_letter_recursively(</span>

<span class="s s-Atom">    host_tuplelist, parasite_tuplelist, host_letter, parasite_letter</span>

<span class="s s-Atom">):</span>

<span class="s s-Atom">    &quot;&quot;&quot;Compare two letters then get next pair of letters recursively.</span>

<span class="s s-Atom">    Returns string for match or no match between the sequences.</span>

<span class="s s-Atom">    &quot;&quot;&quot;</span>

<span class="s s-Atom">    # This function works only for in-frame comparisons and is given the first</span>

<span class="s s-Atom">    # letters of the host and parasite sequences. If the two letters match,</span>

<span class="s s-Atom">    # then gets the next parasite and host letters, and calls itself.</span>

<span class="s s-Atom">    # If can&#39;t</span> <span class="s s-Atom">get</span> <span class="s s-Atom">next</span> <span class="s s-Atom">parasite</span> <span class="s s-Atom">letter</span><span class="p">,</span> <span class="s s-Atom">then</span> <span class="s s-Atom">the</span> <span class="s s-Atom">comparison</span> <span class="s s-Atom">has</span> <span class="s s-Atom">finished</span>

    <span class="s s-Atom">#</span> <span class="s s-Atom">and</span> <span class="s s-Atom">a</span> <span class="s s-Atom">full</span> <span class="s s-Atom">match</span> <span class="s s-Atom">has</span> <span class="s s-Atom">been</span> <span class="s s-Atom">found</span><span class="p">.</span>

    <span class="s s-Atom">#</span> <span class="nv">If</span> <span class="s s-Atom">letters</span> <span class="s s-Atom">do</span> <span class="o">not</span> <span class="s s-Atom">match</span><span class="p">,</span> <span class="s s-Atom">then</span> <span class="s s-Atom">gets</span> <span class="s s-Atom">the</span> <span class="s s-Atom">next</span> <span class="s s-Atom">parasite</span> <span class="s s-Atom">triplet</span> <span class="s s-Atom">and</span> <span class="s s-Atom">calls</span>

    <span class="s s-Atom">#</span> <span class="s s-Atom">itself</span><span class="p">;</span> <span class="s s-Atom">if</span> <span class="s s-Atom">there</span> <span class="s s-Atom">are</span> <span class="s s-Atom">no</span> <span class="s s-Atom">more</span> <span class="s s-Atom">parasite</span> <span class="s s-Atom">triplets</span><span class="p">,</span> <span class="s s-Atom">it</span> <span class="s s-Atom">gets</span> <span class="s s-Atom">the</span> <span class="s s-Atom">next</span> <span class="s s-Atom">host</span>

    <span class="s s-Atom">#</span> <span class="s s-Atom">triplet</span> <span class="s s-Atom">and</span> <span class="s s-Atom">calls</span> <span class="s s-Atom">itself</span><span class="p">.</span> <span class="nv">If</span> <span class="s s-Atom">there</span> <span class="s s-Atom">are</span> <span class="s s-Atom">no</span> <span class="s s-Atom">more</span> <span class="s s-Atom">host</span> <span class="s s-Atom">triplets</span><span class="p">,</span> <span class="s s-Atom">then</span> <span class="s s-Atom">there</span> <span class="o">is</span>

    <span class="s s-Atom">#</span> <span class="s s-Atom">no</span> <span class="s s-Atom">match</span> <span class="s s-Atom">between</span> <span class="s s-Atom">the</span> <span class="s s-Atom">sequences</span><span class="p">.</span>

    <span class="s s-Atom">is_match</span> <span class="o">=</span> <span class="nf">compare_letters</span><span class="p">(</span><span class="s s-Atom">host_letter</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s s-Atom">parasite_letter</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="s s-Atom">if</span> <span class="s s-Atom">is_match:</span>

        <span class="nn">try</span><span class="p">:</span>

            <span class="s s-Atom">next_parasite_letter</span> <span class="o">=</span> <span class="nf">get_next_letter</span><span class="p">(</span>

                <span class="s s-Atom">parasite_tuplelist</span><span class="p">,</span> <span class="s s-Atom">parasite_letter</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

            <span class="p">)</span>

        <span class="nn">except</span><span class="p">:</span>

            <span class="s s-Atom">return</span> <span class="nf">str</span><span class="p">(</span>

                <span class="s2">&quot;Finished parasite sequence, match found! Ending host position:&quot;</span>

                <span class="o">+</span> <span class="nf">str</span><span class="p">(</span><span class="s s-Atom">host_letter</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

            <span class="p">)</span>

        <span class="nn">else</span><span class="p">:</span>

            <span class="s s-Atom">next_host_letter</span> <span class="o">=</span> <span class="nf">get_next_letter</span><span class="p">(</span>

                <span class="s s-Atom">host_tuplelist</span><span class="p">,</span> <span class="s s-Atom">host_letter</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

            <span class="p">)</span>  <span class="s s-Atom">#</span> <span class="s s-Atom">always</span> <span class="nv">OK</span>

            <span class="s s-Atom">return</span> <span class="nf">compare_then_get_letter_recursively</span><span class="p">(</span>

                <span class="s s-Atom">host_tuplelist</span><span class="p">,</span>

                <span class="s s-Atom">parasite_tuplelist</span><span class="p">,</span>

                <span class="s s-Atom">next_host_letter</span><span class="p">,</span>

                <span class="s s-Atom">next_parasite_letter</span><span class="p">,</span>

            <span class="p">)</span>

    <span class="nn">else</span><span class="p">:</span>  <span class="s s-Atom">#</span> <span class="s s-Atom">letters</span> <span class="s s-Atom">do</span> <span class="o">not</span> <span class="s s-Atom">match</span><span class="p">,</span> <span class="s s-Atom">move</span> <span class="s s-Atom">on</span> <span class="s s-Atom">to</span> <span class="s s-Atom">next</span> <span class="s s-Atom">parasite</span> <span class="s s-Atom">triplet</span>

        <span class="nn">try</span><span class="p">:</span>

            <span class="s s-Atom">next_parasite_letter</span> <span class="o">=</span> <span class="nf">get_letter_in_next_triplet</span><span class="p">(</span>

                <span class="s s-Atom">parasite_tuplelist</span><span class="p">,</span> <span class="s s-Atom">parasite_letter</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

            <span class="p">)</span>

        <span class="nn">except</span><span class="p">:</span>  <span class="s s-Atom">#</span> <span class="s s-Atom">no</span> <span class="s s-Atom">more</span> <span class="s s-Atom">parasite</span> <span class="s s-Atom">triplet</span><span class="p">,</span> <span class="s s-Atom">get</span> <span class="s s-Atom">next</span> <span class="s s-Atom">host</span>

            <span class="nn">try</span><span class="p">:</span>

                <span class="s s-Atom">next_host_letter</span> <span class="o">=</span> <span class="nf">get_letter_in_next_triplet</span><span class="p">(</span>

                    <span class="s s-Atom">host_tuplelist</span><span class="p">,</span> <span class="s s-Atom">host_letter</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

                <span class="p">)</span>

            <span class="nn">except</span><span class="p">:</span>

                <span class="s s-Atom">return</span> <span class="s2">&quot;No match for this starting codon position&quot;</span>

            <span class="nn">else</span><span class="p">:</span>

                <span class="s s-Atom">i</span> <span class="o">=</span> <span class="s s-Atom">parasite_letter</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>  <span class="s s-Atom">#</span> <span class="s s-Atom">same</span> <span class="s s-Atom">codon</span>

                <span class="s s-Atom">j</span><span class="p">,</span> <span class="s s-Atom">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>  <span class="s s-Atom">#</span> <span class="s s-Atom">reset</span> <span class="s s-Atom">parasite</span> <span class="s s-Atom">to</span> <span class="s s-Atom">first</span> <span class="s s-Atom">triplet</span><span class="p">,</span> <span class="s s-Atom">first</span> <span class="s s-Atom">letter</span>

                <span class="s s-Atom">next_parasite_letter</span> <span class="o">=</span> <span class="p">(</span><span class="s s-Atom">parasite_tuplelist</span><span class="p">[</span><span class="s s-Atom">i</span><span class="p">][</span><span class="s s-Atom">j</span><span class="p">][</span><span class="s s-Atom">k</span><span class="p">],</span> <span class="p">[</span><span class="s s-Atom">i</span><span class="p">,</span> <span class="s s-Atom">j</span><span class="p">,</span> <span class="s s-Atom">k</span><span class="p">])</span>

                <span class="s s-Atom">return</span> <span class="nf">compare_then_get_letter_recursively</span><span class="p">(</span>

                    <span class="s s-Atom">host_tuplelist</span><span class="p">,</span>

                    <span class="s s-Atom">parasite_tuplelist</span><span class="p">,</span>

                    <span class="s s-Atom">next_host_letter</span><span class="p">,</span>

                    <span class="s s-Atom">next_parasite_letter</span><span class="p">,</span>

                <span class="p">)</span>

        <span class="nn">else</span><span class="p">:</span>

            <span class="s s-Atom">i</span><span class="p">,</span> <span class="s s-Atom">j</span> <span class="o">=</span> <span class="s s-Atom">host_letter</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="s s-Atom">host_letter</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>  <span class="s s-Atom">#</span> <span class="s s-Atom">same</span> <span class="s s-Atom">codon</span><span class="p">,</span> <span class="s s-Atom">same</span> <span class="s s-Atom">triplet</span>

            <span class="s s-Atom">k</span> <span class="o">=</span> <span class="mi">0</span>  <span class="s s-Atom">#</span> <span class="s s-Atom">reset</span> <span class="s s-Atom">host</span> <span class="s s-Atom">letter</span> <span class="s s-Atom">to</span> <span class="s s-Atom">beginning</span> <span class="s s-Atom">of</span> <span class="s s-Atom">triplet</span> <span class="s s-Atom">because</span> <span class="s s-Atom">parasite</span> <span class="s s-Atom">was</span> <span class="s s-Atom">reset</span>

            <span class="s s-Atom">next_host_letter</span> <span class="o">=</span> <span class="p">(</span><span class="s s-Atom">host_tuplelist</span><span class="p">[</span><span class="s s-Atom">i</span><span class="p">][</span><span class="s s-Atom">j</span><span class="p">][</span><span class="s s-Atom">k</span><span class="p">],</span> <span class="p">[</span><span class="s s-Atom">i</span><span class="p">,</span> <span class="s s-Atom">j</span><span class="p">,</span> <span class="s s-Atom">k</span><span class="p">])</span>

            <span class="s s-Atom">return</span> <span class="nf">compare_then_get_letter_recursively</span><span class="p">(</span>

                <span class="s s-Atom">host_tuplelist</span><span class="p">,</span>

                <span class="s s-Atom">parasite_tuplelist</span><span class="p">,</span>

                <span class="s s-Atom">next_host_letter</span><span class="p">,</span>

                <span class="s s-Atom">next_parasite_letter</span><span class="p">,</span>

            <span class="p">)</span>

<span class="s s-Atom">def</span> <span class="nf">walk_seqstep</span><span class="p">(</span><span class="s s-Atom">seqstep</span><span class="p">)</span><span class="s s-Atom">:</span>

    <span class="s2">&quot;&quot;&quot;Compare two sequences by calling `advance_step` until it returns the result.&quot;&quot;&quot;</span>

    <span class="s s-Atom">while</span> <span class="o">not</span> <span class="s s-Atom">seqstep</span><span class="p">.</span><span class="nn">result</span><span class="p">:</span>

        <span class="s s-Atom">seqstep</span><span class="p">.</span><span class="nf">advance_step</span><span class="p">()</span>

<span class="s s-Atom">def</span> <span class="nf">compare_sequence_tuplelists</span><span class="p">(</span><span class="s s-Atom">parasite_tuplelist</span><span class="p">,</span> <span class="s s-Atom">host_tuplelist</span><span class="p">,</span> <span class="s s-Atom">frameshift</span><span class="p">)</span><span class="s s-Atom">:</span>

    <span class="s2">&quot;&quot;&quot;Compare two sequence&#39;s tuplists for given frame and return list of matches.&quot;&quot;&quot;</span>

    <span class="s s-Atom">len_parasite</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="s s-Atom">parasite_tuplelist</span><span class="p">)</span>

    <span class="s s-Atom">len_host</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="s s-Atom">host_tuplelist</span><span class="p">)</span>

    <span class="s s-Atom">list_of_matches</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="s s-Atom">for</span> <span class="s s-Atom">start_host_codon</span> <span class="s s-Atom">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s s-Atom">len_host</span> <span class="o">-</span> <span class="s s-Atom">len_parasite</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="s s-Atom">:</span>

        <span class="s s-Atom">seqstep</span> <span class="o">=</span> <span class="nv">SeqStep</span><span class="p">(</span>

            <span class="s s-Atom">host_tuplelist</span><span class="p">,</span>

            <span class="s s-Atom">parasite_tuplelist</span><span class="p">,</span>

            <span class="s s-Atom">start_host_codon</span><span class="o">=</span><span class="s s-Atom">start_host_codon</span><span class="p">,</span>

            <span class="s s-Atom">frameshift</span><span class="o">=</span><span class="s s-Atom">frameshift</span><span class="p">,</span>

        <span class="p">)</span>

        <span class="nf">walk_seqstep</span><span class="p">(</span><span class="s s-Atom">seqstep</span><span class="p">)</span>

        <span class="s s-Atom">if</span> <span class="s s-Atom">seqstep</span><span class="p">.</span><span class="nn">match</span><span class="p">:</span>

            <span class="s s-Atom">list_of_matches</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="s s-Atom">start_host_codon</span><span class="p">)</span>

    <span class="s s-Atom">return</span> <span class="s s-Atom">list_of_matches</span>

<span class="s s-Atom">def</span> <span class="nf">compare_sequence_tuplelists_in_all_frames</span><span class="p">(</span>

    <span class="s s-Atom">parasite_tuplelist</span><span class="p">,</span> <span class="s s-Atom">host_tuplelist</span><span class="p">,</span> <span class="s s-Atom">prefix=</span><span class="s2">&quot;&quot;</span>

<span class="p">)</span><span class="s s-Atom">:</span>

    <span class="s2">&quot;&quot;&quot;Compare two sequence&#39;s tuplists for all frames and return dict of matches.&quot;&quot;&quot;</span>

    <span class="s s-Atom">results_for_all_frames</span> <span class="o">=</span> <span class="nf">dict</span><span class="p">()</span>

    <span class="s s-Atom">for</span> <span class="s s-Atom">frameshift</span> <span class="s s-Atom">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="s s-Atom">:</span>

        <span class="s s-Atom">result</span> <span class="o">=</span> <span class="nf">compare_sequence_tuplelists</span><span class="p">(</span>

            <span class="s s-Atom">parasite_tuplelist</span><span class="p">,</span> <span class="s s-Atom">host_tuplelist</span><span class="p">,</span> <span class="s s-Atom">frameshift</span>

        <span class="p">)</span>

        <span class="s s-Atom">key</span> <span class="o">=</span> <span class="s s-Atom">prefix</span> <span class="o">+</span> <span class="nf">str</span><span class="p">(</span><span class="s s-Atom">frameshift</span><span class="p">)</span>

        <span class="s s-Atom">results_for_all_frames</span><span class="p">[</span><span class="s s-Atom">key</span><span class="p">]</span> <span class="o">=</span> <span class="s s-Atom">result</span>

    <span class="s s-Atom">return</span> <span class="s s-Atom">results_for_all_frames</span>

<span class="s s-Atom">def</span> <span class="nf">find_partial_overlaps</span><span class="p">(</span><span class="s s-Atom">host</span><span class="p">,</span> <span class="s s-Atom">parasite</span><span class="p">,</span> <span class="s s-Atom">swaptable</span><span class="p">,</span> <span class="s s-Atom">verbose</span><span class="o">=</span><span class="nv">True</span><span class="p">)</span><span class="s s-Atom">:</span>

    <span class="s s-Atom">flank</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="s s-Atom">parasite</span><span class="p">)</span> <span class="o">*</span> <span class="s2">&quot;N&quot;</span>

    <span class="s s-Atom">host_flank</span> <span class="o">=</span> <span class="s s-Atom">flank</span> <span class="o">+</span> <span class="s s-Atom">host</span> <span class="o">+</span> <span class="s s-Atom">flank</span>

    <span class="s s-Atom">swaptable</span><span class="p">[</span><span class="s2">&quot;NNN&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;NNN&quot;</span><span class="p">,)</span>

    <span class="s s-Atom">result</span> <span class="o">=</span> <span class="nf">make_genealloy</span><span class="p">(</span><span class="s s-Atom">host_flank</span><span class="p">,</span> <span class="s s-Atom">parasite</span><span class="p">,</span> <span class="s s-Atom">swaptable</span><span class="p">,</span> <span class="s s-Atom">verbose</span><span class="o">=</span><span class="nv">True</span><span class="p">)</span>

    <span class="s s-Atom">return</span> <span class="s s-Atom">result</span>

<span class="s s-Atom">def</span> <span class="nf">make_genealloy</span><span class="p">(</span><span class="s s-Atom">host</span><span class="p">,</span> <span class="s s-Atom">parasite</span><span class="p">,</span> <span class="s s-Atom">swaptable</span><span class="p">,</span> <span class="s s-Atom">verbose</span><span class="o">=</span><span class="nv">True</span><span class="p">)</span><span class="s s-Atom">:</span>

    <span class="s2">&quot;&quot;&quot;Compare two sequence strings and return dictionary of matches.&quot;&quot;&quot;</span>

    <span class="s s-Atom">host_codons</span> <span class="o">=</span> <span class="nf">convert_seq_to_codons</span><span class="p">(</span><span class="s s-Atom">host</span><span class="p">)</span>

    <span class="s s-Atom">host_tuplelist</span> <span class="o">=</span> <span class="nf">convert_codonlist_to_tuplelist</span><span class="p">(</span><span class="s s-Atom">host_codons</span><span class="p">,</span> <span class="s s-Atom">swaptable</span><span class="p">)</span>

    <span class="s s-Atom">parasite_codons</span> <span class="o">=</span> <span class="nf">convert_seq_to_codons</span><span class="p">(</span><span class="s s-Atom">parasite</span><span class="p">)</span>

    <span class="s s-Atom">parasite_tuplelist</span> <span class="o">=</span> <span class="nf">convert_codonlist_to_tuplelist</span><span class="p">(</span><span class="s s-Atom">parasite_codons</span><span class="p">,</span> <span class="s s-Atom">swaptable</span><span class="p">)</span>

    <span class="s s-Atom">forward_results</span> <span class="o">=</span> <span class="nf">compare_sequence_tuplelists_in_all_frames</span><span class="p">(</span>

        <span class="s s-Atom">parasite_tuplelist</span><span class="p">,</span> <span class="s s-Atom">host_tuplelist</span><span class="p">,</span> <span class="s s-Atom">prefix=</span><span class="s2">&quot;f_&quot;</span>

    <span class="p">)</span>

    <span class="s s-Atom">reverse_complement_tuplelist</span> <span class="o">=</span> <span class="nf">get_reverse_complement_tuplelist</span><span class="p">(</span><span class="s s-Atom">host_tuplelist</span><span class="p">)</span>

    <span class="s s-Atom">reverse_complement_results</span> <span class="o">=</span> <span class="nf">compare_sequence_tuplelists_in_all_frames</span><span class="p">(</span>

        <span class="s s-Atom">parasite_tuplelist</span><span class="p">,</span> <span class="s s-Atom">reverse_complement_tuplelist</span><span class="p">,</span> <span class="s s-Atom">prefix=</span><span class="s2">&quot;rc_&quot;</span>

    <span class="p">)</span>

    <span class="s s-Atom">result</span> <span class="o">=</span> <span class="s s-Atom">forward_results</span><span class="p">.</span><span class="nf">copy</span><span class="p">()</span>

    <span class="s s-Atom">result</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="s s-Atom">reverse_complement_results</span><span class="p">)</span>

    <span class="s s-Atom">if</span> <span class="nn">verbose</span><span class="p">:</span>

        <span class="s s-Atom">if</span> <span class="nf">all</span><span class="p">(</span><span class="s s-Atom">value</span> <span class="o">==</span> <span class="p">[]</span> <span class="s s-Atom">for</span> <span class="s s-Atom">value</span> <span class="s s-Atom">in</span> <span class="s s-Atom">result</span><span class="p">.</span><span class="nf">values</span><span class="p">())</span><span class="s s-Atom">:</span>

            <span class="nf">print</span><span class="p">(</span><span class="s2">&quot;These sequences cannot be mixed&quot;</span><span class="p">)</span>

        <span class="nn">else</span><span class="p">:</span>

            <span class="nf">print</span><span class="p">(</span><span class="s2">&quot;A genealloy can be made using these sequences!&quot;</span><span class="p">)</span>

    <span class="s s-Atom">return</span> <span class="s s-Atom">result</span>

<span class="s s-Atom">def</span> <span class="nf">get_complement_tuplelist</span><span class="p">(</span><span class="s s-Atom">codon_tuplelist</span><span class="p">)</span><span class="s s-Atom">:</span>

    <span class="s2">&quot;&quot;&quot;Get complement triplets of a sequence tuplelist.&quot;&quot;&quot;</span>

    <span class="s s-Atom">complement_tuplelist</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="s s-Atom">for</span> <span class="s s-Atom">index</span><span class="p">,</span> <span class="s s-Atom">codon</span> <span class="s s-Atom">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="s s-Atom">codon_tuplelist</span><span class="p">)</span><span class="s s-Atom">:</span>

        <span class="s s-Atom">complement_tripletlist</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="s s-Atom">for</span> <span class="s s-Atom">triplet</span> <span class="s s-Atom">in</span> <span class="nn">codon</span><span class="p">:</span>

            <span class="s s-Atom">letter1</span> <span class="o">=</span> <span class="s s-Atom">triplet</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="s s-Atom">letter2</span> <span class="o">=</span> <span class="s s-Atom">triplet</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

            <span class="s s-Atom">letter3</span> <span class="o">=</span> <span class="s s-Atom">triplet</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

            <span class="s s-Atom">complement_triplet</span> <span class="o">=</span> <span class="p">(</span>

                <span class="s s-Atom">complement_table</span><span class="p">[</span><span class="s s-Atom">letter1</span><span class="p">]</span>

                <span class="o">+</span> <span class="s s-Atom">complement_table</span><span class="p">[</span><span class="s s-Atom">letter2</span><span class="p">]</span>

                <span class="o">+</span> <span class="s s-Atom">complement_table</span><span class="p">[</span><span class="s s-Atom">letter3</span><span class="p">]</span>

            <span class="p">)</span>

            <span class="s s-Atom">complement_tripletlist</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="s s-Atom">complement_triplet</span><span class="p">)</span>

        <span class="s s-Atom">complement_codon</span> <span class="o">=</span> <span class="nf">tuple</span><span class="p">(</span><span class="s s-Atom">complement_tripletlist</span><span class="p">)</span>

        <span class="s s-Atom">complement_tuplelist</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="s s-Atom">complement_codon</span><span class="p">)</span>

    <span class="s s-Atom">return</span> <span class="s s-Atom">complement_tuplelist</span>

<span class="s s-Atom">def</span> <span class="nf">get_reverse_tuplelist</span><span class="p">(</span><span class="s s-Atom">codon_tuplelist</span><span class="p">)</span><span class="s s-Atom">:</span>

    <span class="s2">&quot;&quot;&quot;Get reverse of a tuplelist with reversed triplets.&quot;&quot;&quot;</span>

    <span class="s s-Atom">reverse_tuplelist</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="s s-Atom">for</span> <span class="s s-Atom">codon</span> <span class="s s-Atom">in</span> <span class="nf">reversed</span><span class="p">(</span><span class="s s-Atom">codon_tuplelist</span><span class="p">)</span><span class="s s-Atom">:</span>

        <span class="s s-Atom">reverse_tripletlist</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="s s-Atom">for</span> <span class="s s-Atom">triplet</span> <span class="s s-Atom">in</span> <span class="nn">codon</span><span class="p">:</span>

            <span class="s s-Atom">reverse_triplet</span> <span class="o">=</span> <span class="s s-Atom">triplet</span><span class="p">[</span><span class="s s-Atom">::-</span><span class="mi">1</span><span class="p">]</span>

            <span class="s s-Atom">reverse_tripletlist</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="s s-Atom">reverse_triplet</span><span class="p">)</span>

        <span class="s s-Atom">reverse_codon</span> <span class="o">=</span> <span class="nf">tuple</span><span class="p">(</span><span class="s s-Atom">reverse_tripletlist</span><span class="p">)</span>

        <span class="s s-Atom">reverse_tuplelist</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="s s-Atom">reverse_codon</span><span class="p">)</span>

    <span class="s s-Atom">return</span> <span class="s s-Atom">reverse_tuplelist</span>

<span class="s s-Atom">def</span> <span class="nf">get_reverse_complement_tuplelist</span><span class="p">(</span><span class="s s-Atom">codon_tuplelist</span><span class="p">)</span><span class="s s-Atom">:</span>

    <span class="s2">&quot;&quot;&quot;Get reverse complement of a sequence&#39;s tuplelist.&quot;&quot;&quot;</span>

    <span class="s s-Atom">complement_tuplelist</span> <span class="o">=</span> <span class="nf">get_complement_tuplelist</span><span class="p">(</span><span class="s s-Atom">codon_tuplelist</span><span class="p">)</span>

    <span class="s s-Atom">reverse_complement_tuplelist</span> <span class="o">=</span> <span class="nf">get_reverse_tuplelist</span><span class="p">(</span><span class="s s-Atom">complement_tuplelist</span><span class="p">)</span>

    <span class="s s-Atom">return</span> <span class="s s-Atom">reverse_complement_tuplelist</span>

<span class="s s-Atom">class</span> <span class="nv">Duodon</span><span class="s s-Atom">:</span>

    <span class="s2">&quot;&quot;&quot;Class for storing two triplets&quot;&quot;&quot;</span>

    <span class="s s-Atom">def</span> <span class="k">__</span><span class="nf">init__</span><span class="p">(</span><span class="s s-Atom">self</span><span class="p">,</span> <span class="s s-Atom">first_triplet</span><span class="p">,</span> <span class="s s-Atom">second_triplet</span><span class="p">)</span><span class="s s-Atom">:</span>

        <span class="s s-Atom">self</span><span class="p">.</span><span class="s s-Atom">first_triplet</span> <span class="o">=</span> <span class="s s-Atom">first_triplet</span>

        <span class="s s-Atom">self</span><span class="p">.</span><span class="s s-Atom">second_triplet</span> <span class="o">=</span> <span class="s s-Atom">second_triplet</span>

<span class="s s-Atom">class</span> <span class="nv">SeqStep</span><span class="s s-Atom">:</span>

    <span class="s2">&quot;&quot;&quot;Class for keeping track of sequence comparison</span>

<span class="s2">    It stores a method that aligns a parasite triplet with two consecutive host</span>

<span class="s2">    triplets (duodons), a cursor that marks the position of the comparison process,</span>

<span class="s2">    and methods for generating duodons and comparing them with triplets.</span>

<span class="s2">    The `advance_step()` method attempts to advance the comparison by one codon</span>

<span class="s2">    step. It can (i) advance the cursor or (ii) conclude that there is no match</span>

<span class="s2">    between the sequences, or (iii) conclude that there is a match.</span>

<span class="s2">    Parameters</span>

<span class="s2">    ----------</span>

<span class="s2">    host_tuplelist</span>

<span class="s2">      A list of tuples. Each tuple stores the allowed triplets for a codon</span>

<span class="s2">      position of the host sequence.</span>

<span class="s2">    parasite_tuplelist</span>

<span class="s2">      A list of tuples. Each tuple stores the allowed triplets for a codon</span>

<span class="s2">      position of the parasite sequence.</span>

<span class="s2">    frameshift</span>

<span class="s2">      An integer (0, 1 or 2) denoting the frameshift between host and parasite.</span>

<span class="s2">    start_host_codon</span>

<span class="s2">      The host codon position from which the comparison should start.</span>

<span class="s2">    &quot;&quot;&quot;</span>

    <span class="s s-Atom">def</span> <span class="k">__</span><span class="nf">init__</span><span class="p">(</span>

        <span class="s s-Atom">self</span><span class="p">,</span> <span class="s s-Atom">host_tuplelist</span><span class="p">,</span> <span class="s s-Atom">parasite_tuplelist</span><span class="p">,</span> <span class="s s-Atom">frameshift</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="s s-Atom">start_host_codon</span><span class="o">=</span><span class="mi">0</span>

    <span class="p">)</span><span class="s s-Atom">:</span>

        <span class="s s-Atom">self</span><span class="p">.</span><span class="s s-Atom">host_tuplelist</span> <span class="o">=</span> <span class="s s-Atom">host_tuplelist</span>

        <span class="s s-Atom">self</span><span class="p">.</span><span class="s s-Atom">parasite_tuplelist</span> <span class="o">=</span> <span class="s s-Atom">parasite_tuplelist</span>

        <span class="s s-Atom">self</span><span class="p">.</span><span class="s s-Atom">frameshift</span> <span class="o">=</span> <span class="s s-Atom">frameshift</span>

        <span class="s s-Atom">self</span><span class="p">.</span><span class="s s-Atom">start_host_codon</span> <span class="o">=</span> <span class="s s-Atom">start_host_codon</span>

        <span class="s s-Atom">self</span><span class="p">.</span><span class="s s-Atom">cursor</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="s s-Atom">self</span><span class="p">.</span><span class="s s-Atom">len_parasite</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="s s-Atom">parasite_tuplelist</span><span class="p">)</span>

        <span class="s s-Atom">self</span><span class="p">.</span><span class="s s-Atom">len_host</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="s s-Atom">host_tuplelist</span><span class="p">)</span>

        <span class="s s-Atom">self</span><span class="p">.</span><span class="s s-Atom">parasite_path</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="s s-Atom">self</span><span class="p">.</span><span class="s s-Atom">host_path</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="s s-Atom">self</span><span class="p">.</span><span class="s s-Atom">match</span> <span class="o">=</span> <span class="nv">False</span>

        <span class="s s-Atom">self</span><span class="p">.</span><span class="s s-Atom">result</span> <span class="o">=</span> <span class="nv">None</span>

    <span class="s s-Atom">def</span> <span class="nf">generate_duodons</span><span class="p">(</span><span class="s s-Atom">self</span><span class="p">)</span><span class="s s-Atom">:</span>

        <span class="s s-Atom">self</span><span class="p">.</span><span class="s s-Atom">cursor</span>

        <span class="s s-Atom">self</span><span class="p">.</span><span class="s s-Atom">start_host_codon</span>

        <span class="s s-Atom">duodons</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="s s-Atom">host_codon</span> <span class="o">=</span> <span class="s s-Atom">self</span><span class="p">.</span><span class="s s-Atom">start_host_codon</span> <span class="o">+</span> <span class="s s-Atom">self</span><span class="p">.</span><span class="s s-Atom">cursor</span>

        <span class="s s-Atom">if</span> <span class="s s-Atom">self</span><span class="p">.</span><span class="s s-Atom">host_path</span> <span class="o">==</span> <span class="p">[]</span><span class="s s-Atom">:</span>  <span class="s s-Atom">#</span> <span class="s s-Atom">first</span> <span class="s s-Atom">time</span> <span class="s s-Atom">it&#39;s made</span>

<span class="s s-Atom">            for triplet_1 in self.host_tuplelist[host_codon]:</span>

<span class="s s-Atom">                for triplet_2 in self.host_tuplelist[host_codon + 1]:</span>

<span class="s s-Atom">                    duodons.append(Duodon(triplet_1, triplet_2))</span>

<span class="s s-Atom">        else:</span>

<span class="s s-Atom">            triplet_1 = self.host_path[-1].second_triplet  # of last used duodon</span>

<span class="s s-Atom">            try:</span>

<span class="s s-Atom">                for triplet_2 in self.host_tuplelist[host_codon + 1]:</span>

<span class="s s-Atom">                    duodons.append(Duodon(triplet_1, triplet_2))</span>

<span class="s s-Atom">            except:</span>

<span class="s s-Atom">                duodons.append(Duodon(triplet_1, &quot;NNN&quot;))</span>

<span class="s s-Atom">        return duodons</span>

<span class="s s-Atom">    def return_all_matching_duodons(self, triplet, duodons, frameshift=0):</span>

<span class="s s-Atom">        matching_duodons = []</span>

<span class="s s-Atom">        for duodon in duodons:</span>

<span class="s s-Atom">            host_letters = duodon.first_triplet + duodon.second_triplet</span>

<span class="s s-Atom">            # compare 1st letter:</span>

<span class="s s-Atom">            if not compare_letters(host_letters[0 + frameshift], triplet[0]):</span>

<span class="s s-Atom">                continue</span>

<span class="s s-Atom">            if not compare_letters(host_letters[1 + frameshift], triplet[1]):</span>

<span class="s s-Atom">                continue</span>

<span class="s s-Atom">            if not compare_letters(host_letters[2 + frameshift], triplet[2]):</span>

<span class="s s-Atom">                continue</span>

<span class="s s-Atom">            matching_duodons.append(duodon)</span>

<span class="s s-Atom">        return matching_duodons</span>

<span class="s s-Atom">    def compare_triplet_and_duodon(self, triplet, duodon, frameshift=0):</span>

<span class="s s-Atom">        host_letters = duodon.first_triplet + duodon.second_triplet</span>

<span class="s s-Atom">        if not compare_letters(host_letters[0 + frameshift], triplet[0]):</span>

<span class="s s-Atom">            return False</span>

<span class="s s-Atom">        if not compare_letters(host_letters[1 + frameshift], triplet[1]):</span>

<span class="s s-Atom">            return False</span>

<span class="s s-Atom">        if not compare_letters(host_letters[2 + frameshift], triplet[2]):</span>

<span class="s s-Atom">            return False</span>

<span class="s s-Atom">        return True</span>

<span class="s s-Atom">    def advance_step(self):</span>

<span class="s s-Atom">        if self.result:</span>

<span class="s s-Atom">            return self.result</span>

<span class="s s-Atom">        if self.cursor == self.len_parasite:</span>

<span class="s s-Atom">            self.match = True</span>

<span class="s s-Atom">            self.result = (</span>

<span class="s s-Atom">                &quot;Match found between parasite and host sequence. Start codon was: &quot;</span>

<span class="s s-Atom">                + str(self.start_host_codon)</span>

<span class="s s-Atom">            )</span>

<span class="s s-Atom">            return self.result</span>

<span class="s s-Atom">        parasite_triplets = list(self.parasite_tuplelist[self.cursor])</span>

<span class="s s-Atom">        host_duodons = self.generate_duodons()</span>

<span class="s s-Atom">        while True:</span>

<span class="s s-Atom">            try:</span>

<span class="s s-Atom">                parasite_triplet = parasite_triplets[0]</span>

<span class="s s-Atom">            except:</span>

<span class="s s-Atom">                self.result = &quot;Sequences don&#39;t</span> <span class="s s-Atom">match</span><span class="p">.</span> <span class="nv">Start</span> <span class="s s-Atom">codon</span> <span class="nn">was</span><span class="p">:</span> <span class="s2">&quot; + str(</span>

<span class="s2">                    self.start_host_codon</span>

<span class="s2">                )</span>

<span class="s2">                return self.result</span>

<span class="s2">            else:</span>

<span class="s2">                host_duodons_for_parasite_triplet = host_duodons[:]</span>

<span class="s2">                host_duodons_for_parasite_triplet = self.return_all_matching_duodons(</span>

<span class="s2">                    parasite_triplet,</span>

<span class="s2">                    host_duodons_for_parasite_triplet,</span>

<span class="s2">                    frameshift=self.frameshift,</span>

<span class="s2">                )</span>

<span class="s2">                self.parasite_path.append(parasite_triplet)</span>

<span class="s2">                while True:</span>

<span class="s2">                    try:</span>

<span class="s2">                        host_doudon = host_duodons_for_parasite_triplet[0]</span>

<span class="s2">                    except:</span>

<span class="s2">                        self.parasite_path.pop()</span>

<span class="s2">                        del parasite_triplets[0]</span>

<span class="s2">                        break</span>

<span class="s2">                    else:</span>

<span class="s2">                        if self.compare_triplet_and_duodon(</span>

<span class="s2">                            parasite_triplet, host_doudon, frameshift=self.frameshift</span>

<span class="s2">                        ):</span>

<span class="s2">                            self.host_path.append(host_doudon)</span>

<span class="s2">                            self.cursor += 1</span>

<span class="s2">                            return &quot;</span><span class="nv">Codon</span> <span class="s s-Atom">matched</span><span class="p">,</span> <span class="s s-Atom">cursor</span> <span class="s s-Atom">advanced</span><span class="err">&quot;</span>

                        <span class="nn">else</span><span class="p">:</span>

                            <span class="s s-Atom">del</span> <span class="s s-Atom">host_duodons_for_parasite_triplet</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div>


</details>
<h2 id="variables">Variables</h2>
<div class="codehilite"><pre><span></span><code><span class="n">aa_to_codon_extended</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">codon_extended_to_aa</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">codon_to_aa</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">complement_table</span>
</code></pre></div>


<h2 id="functions">Functions</h2>
<h3 id="compare_sequence_tuplelists">compare_sequence_tuplelists</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">compare_sequence_tuplelists</span><span class="p">(</span>
    <span class="n">parasite_tuplelist</span><span class="p">,</span>
    <span class="n">host_tuplelist</span><span class="p">,</span>
    <span class="n">frameshift</span>
<span class="p">)</span>
</code></pre></div>


<p>Compare two sequence's tuplists for given frame and return list of matches.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">compare_sequence_tuplelists</span><span class="p">(</span><span class="n">parasite_tuplelist</span><span class="p">,</span> <span class="n">host_tuplelist</span><span class="p">,</span> <span class="n">frameshift</span><span class="p">):</span>

    <span class="ss">&quot;&quot;&quot;Compare two sequence&#39;s tuplists for given frame and return list of matches.&quot;&quot;&quot;</span>

    <span class="n">len_parasite</span> <span class="o">=</span> <span class="n">len</span><span class="p">(</span><span class="n">parasite_tuplelist</span><span class="p">)</span>

    <span class="n">len_host</span> <span class="o">=</span> <span class="n">len</span><span class="p">(</span><span class="n">host_tuplelist</span><span class="p">)</span>

    <span class="n">list_of_matches</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">start_host_codon</span> <span class="k">in</span> <span class="n">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">len_host</span> <span class="o">-</span> <span class="n">len_parasite</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>

        <span class="n">seqstep</span> <span class="o">=</span> <span class="n">SeqStep</span><span class="p">(</span>

            <span class="n">host_tuplelist</span><span class="p">,</span>

            <span class="n">parasite_tuplelist</span><span class="p">,</span>

            <span class="n">start_host_codon</span><span class="o">=</span><span class="n">start_host_codon</span><span class="p">,</span>

            <span class="n">frameshift</span><span class="o">=</span><span class="n">frameshift</span><span class="p">,</span>

        <span class="p">)</span>

        <span class="n">walk_seqstep</span><span class="p">(</span><span class="n">seqstep</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">seqstep</span><span class="p">.</span><span class="k">match</span><span class="p">:</span>

            <span class="n">list_of_matches</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">start_host_codon</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">list_of_matches</span>
</code></pre></div>


</details>
<h3 id="compare_sequence_tuplelists_in_all_frames">compare_sequence_tuplelists_in_all_frames</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">compare_sequence_tuplelists_in_all_frames</span><span class="p">(</span>
    <span class="n">parasite_tuplelist</span><span class="p">,</span>
    <span class="n">host_tuplelist</span><span class="p">,</span>
    <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
<span class="p">)</span>
</code></pre></div>


<p>Compare two sequence's tuplists for all frames and return dict of matches.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">compare_sequence_tuplelists_in_all_frames</span><span class="p">(</span><span class="w"></span>

<span class="w">    </span><span class="n">parasite_tuplelist</span><span class="p">,</span><span class="w"> </span><span class="n">host_tuplelist</span><span class="p">,</span><span class="w"> </span><span class="k">prefix</span><span class="o">=</span><span class="ss">&quot;&quot;</span><span class="w"></span>

<span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot;Compare two sequence&#39;s tuplists for all frames and return dict of matches.&quot;&quot;&quot;</span><span class="w"></span>

<span class="w">    </span><span class="n">results_for_all_frames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dict</span><span class="p">()</span><span class="w"></span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">frameshift</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">[</span><span class="n">0, 1, 2</span><span class="o">]</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">compare_sequence_tuplelists</span><span class="p">(</span><span class="w"></span>

<span class="w">            </span><span class="n">parasite_tuplelist</span><span class="p">,</span><span class="w"> </span><span class="n">host_tuplelist</span><span class="p">,</span><span class="w"> </span><span class="n">frameshift</span><span class="w"></span>

<span class="w">        </span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">prefix</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">str</span><span class="p">(</span><span class="n">frameshift</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">results_for_all_frames</span><span class="o">[</span><span class="n">key</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">result</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">results_for_all_frames</span><span class="w"></span>
</code></pre></div>


</details>
<h3 id="compare_then_get_letter_recursively">compare_then_get_letter_recursively</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">compare_then_get_letter_recursively</span><span class="p">(</span>
    <span class="n">host_tuplelist</span><span class="p">,</span>
    <span class="n">parasite_tuplelist</span><span class="p">,</span>
    <span class="n">host_letter</span><span class="p">,</span>
    <span class="n">parasite_letter</span>
<span class="p">)</span>
</code></pre></div>


<p>Compare two letters then get next pair of letters recursively.</p>
<p>Returns string for match or no match between the sequences.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">compare_then_get_letter_recursively</span><span class="p">(</span><span class="w"></span>

<span class="w">    </span><span class="n">host_tuplelist</span><span class="p">,</span><span class="w"> </span><span class="n">parasite_tuplelist</span><span class="p">,</span><span class="w"> </span><span class="n">host_letter</span><span class="p">,</span><span class="w"> </span><span class="n">parasite_letter</span><span class="w"></span>

<span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot;Compare two letters then get next pair of letters recursively.</span>

<span class="ss">    Returns string for match or no match between the sequences.</span>

<span class="ss">    &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">works</span><span class="w"> </span><span class="k">only</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="ow">in</span><span class="o">-</span><span class="n">frame</span><span class="w"> </span><span class="n">comparisons</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">first</span><span class="w"></span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">letters</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">host</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">parasite</span><span class="w"> </span><span class="n">sequences</span><span class="p">.</span><span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">two</span><span class="w"> </span><span class="n">letters</span><span class="w"> </span><span class="k">match</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">gets</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">next</span><span class="w"> </span><span class="n">parasite</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">host</span><span class="w"> </span><span class="n">letters</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">calls</span><span class="w"> </span><span class="n">itself</span><span class="p">.</span><span class="w"></span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="n">can</span><span class="err">&#39;</span><span class="n">t</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="k">next</span><span class="w"> </span><span class="n">parasite</span><span class="w"> </span><span class="n">letter</span><span class="p">,</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">comparison</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">finished</span><span class="w"></span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">full</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="k">found</span><span class="p">.</span><span class="w"></span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="n">letters</span><span class="w"> </span><span class="n">do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">match</span><span class="p">,</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">gets</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">next</span><span class="w"> </span><span class="n">parasite</span><span class="w"> </span><span class="n">triplet</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">calls</span><span class="w"></span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">itself</span><span class="p">;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="k">no</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">parasite</span><span class="w"> </span><span class="n">triplets</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">gets</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">next</span><span class="w"> </span><span class="k">host</span><span class="w"></span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">triplet</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">calls</span><span class="w"> </span><span class="n">itself</span><span class="p">.</span><span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="k">no</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="k">host</span><span class="w"> </span><span class="n">triplets</span><span class="p">,</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="k">is</span><span class="w"></span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="k">no</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="ow">between</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sequences</span><span class="p">.</span><span class="w"></span>

<span class="w">    </span><span class="n">is_match</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">compare_letters</span><span class="p">(</span><span class="n">host_letter</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">parasite_letter</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nl">is_match</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="k">try</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">next_parasite_letter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_next_letter</span><span class="p">(</span><span class="w"></span>

<span class="w">                </span><span class="n">parasite_tuplelist</span><span class="p">,</span><span class="w"> </span><span class="n">parasite_letter</span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="w"></span>

<span class="w">            </span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="ow">except</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="nf">str</span><span class="p">(</span><span class="w"></span>

<span class="w">                </span><span class="ss">&quot;Finished parasite sequence, match found! Ending host position:&quot;</span><span class="w"></span>

<span class="w">                </span><span class="o">+</span><span class="w"> </span><span class="nf">str</span><span class="p">(</span><span class="n">host_letter</span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">else</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">next_host_letter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_next_letter</span><span class="p">(</span><span class="w"></span>

<span class="w">                </span><span class="n">host_tuplelist</span><span class="p">,</span><span class="w"> </span><span class="n">host_letter</span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="w"></span>

<span class="w">            </span><span class="p">)</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="n">OK</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">compare_then_get_letter_recursively</span><span class="p">(</span><span class="w"></span>

<span class="w">                </span><span class="n">host_tuplelist</span><span class="p">,</span><span class="w"></span>

<span class="w">                </span><span class="n">parasite_tuplelist</span><span class="p">,</span><span class="w"></span>

<span class="w">                </span><span class="n">next_host_letter</span><span class="p">,</span><span class="w"></span>

<span class="w">                </span><span class="n">next_parasite_letter</span><span class="p">,</span><span class="w"></span>

<span class="w">            </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">else</span><span class="err">:</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="n">letters</span><span class="w"> </span><span class="n">do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">match</span><span class="p">,</span><span class="w"> </span><span class="n">move</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">next</span><span class="w"> </span><span class="n">parasite</span><span class="w"> </span><span class="n">triplet</span><span class="w"></span>

<span class="w">        </span><span class="k">try</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">next_parasite_letter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_letter_in_next_triplet</span><span class="p">(</span><span class="w"></span>

<span class="w">                </span><span class="n">parasite_tuplelist</span><span class="p">,</span><span class="w"> </span><span class="n">parasite_letter</span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="w"></span>

<span class="w">            </span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="ow">except</span><span class="err">:</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="k">no</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">parasite</span><span class="w"> </span><span class="n">triplet</span><span class="p">,</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="k">next</span><span class="w"> </span><span class="k">host</span><span class="w"></span>

<span class="w">            </span><span class="k">try</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="n">next_host_letter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_letter_in_next_triplet</span><span class="p">(</span><span class="w"></span>

<span class="w">                    </span><span class="n">host_tuplelist</span><span class="p">,</span><span class="w"> </span><span class="n">host_letter</span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="w"></span>

<span class="w">                </span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="ow">except</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="ss">&quot;No match for this starting codon position&quot;</span><span class="w"></span>

<span class="w">            </span><span class="k">else</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parasite_letter</span><span class="o">[</span><span class="n">1</span><span class="o">][</span><span class="n">0</span><span class="o">]</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">codon</span><span class="w"></span>

<span class="w">                </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="n">reset</span><span class="w"> </span><span class="n">parasite</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">first</span><span class="w"> </span><span class="n">triplet</span><span class="p">,</span><span class="w"> </span><span class="k">first</span><span class="w"> </span><span class="n">letter</span><span class="w"></span>

<span class="w">                </span><span class="n">next_parasite_letter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">parasite_tuplelist</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">][</span><span class="n">k</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="o">[</span><span class="n">i, j, k</span><span class="o">]</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">compare_then_get_letter_recursively</span><span class="p">(</span><span class="w"></span>

<span class="w">                    </span><span class="n">host_tuplelist</span><span class="p">,</span><span class="w"></span>

<span class="w">                    </span><span class="n">parasite_tuplelist</span><span class="p">,</span><span class="w"></span>

<span class="w">                    </span><span class="n">next_host_letter</span><span class="p">,</span><span class="w"></span>

<span class="w">                    </span><span class="n">next_parasite_letter</span><span class="p">,</span><span class="w"></span>

<span class="w">                </span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">else</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">host_letter</span><span class="o">[</span><span class="n">1</span><span class="o">][</span><span class="n">0</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">host_letter</span><span class="o">[</span><span class="n">1</span><span class="o">][</span><span class="n">1</span><span class="o">]</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">codon</span><span class="p">,</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">triplet</span><span class="w"></span>

<span class="w">            </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="n">reset</span><span class="w"> </span><span class="k">host</span><span class="w"> </span><span class="n">letter</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">beginning</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">triplet</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">parasite</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">reset</span><span class="w"></span>

<span class="w">            </span><span class="n">next_host_letter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">host_tuplelist</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">][</span><span class="n">k</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="o">[</span><span class="n">i, j, k</span><span class="o">]</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">compare_then_get_letter_recursively</span><span class="p">(</span><span class="w"></span>

<span class="w">                </span><span class="n">host_tuplelist</span><span class="p">,</span><span class="w"></span>

<span class="w">                </span><span class="n">parasite_tuplelist</span><span class="p">,</span><span class="w"></span>

<span class="w">                </span><span class="n">next_host_letter</span><span class="p">,</span><span class="w"></span>

<span class="w">                </span><span class="n">next_parasite_letter</span><span class="p">,</span><span class="w"></span>

<span class="w">            </span><span class="p">)</span><span class="w"></span>
</code></pre></div>


</details>
<h3 id="convert_codonlist_to_tuplelist">convert_codonlist_to_tuplelist</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">convert_codonlist_to_tuplelist</span><span class="p">(</span>
    <span class="n">seq_codons</span><span class="p">,</span>
    <span class="n">codon_to_codon_extended</span>
<span class="p">)</span>
</code></pre></div>


<p>Convert a list of triplets into a list of tuples, using a swaptable.</p>
<p>The swaptable is a dict of triplet: triplets, and determines the
allowed swaps.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">convert_codonlist_to_tuplelist</span><span class="p">(</span><span class="n">seq_codons</span><span class="p">,</span><span class="w"> </span><span class="n">codon_to_codon_extended</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot;Convert a list of triplets into a list of tuples, using a swaptable.</span>

<span class="ss">    The swaptable is a dict of triplet: triplets, and determines the</span>

<span class="ss">    allowed swaps.</span>

<span class="ss">    &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">    </span><span class="n">codon_extended</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">None</span><span class="o">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">seq_codons</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">codon</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">seq_codons</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="n">codon_extended</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">codon_to_codon_extended</span><span class="o">[</span><span class="n">codon</span><span class="o">]</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">codon_extended</span><span class="w"></span>
</code></pre></div>


</details>
<h3 id="convert_seq_to_codons">convert_seq_to_codons</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">convert_seq_to_codons</span><span class="p">(</span>
    <span class="n">seq</span>
<span class="p">)</span>
</code></pre></div>


<p>Convert a string (sequence) into a list of 3-letter strings (triplets).</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">convert_seq_to_codons</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span><span class="o">:</span>

    <span class="s">&quot;&quot;&quot;Convert a string (sequence) into a list of 3-letter strings (triplets).&quot;&quot;&quot;</span>

    <span class="n">seq_codons</span> <span class="o">=</span> <span class="p">[</span><span class="n">seq</span><span class="p">[</span><span class="nl">i</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="n">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">len</span><span class="p">(</span><span class="n">seq</span><span class="p">),</span> <span class="mi">3</span><span class="p">)]</span>

    <span class="k">return</span> <span class="n">seq_codons</span>
</code></pre></div>


</details>
<h3 id="find_partial_overlaps">find_partial_overlaps</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">find_partial_overlaps</span><span class="p">(</span>
    <span class="n">host</span><span class="p">,</span>
    <span class="n">parasite</span><span class="p">,</span>
    <span class="n">swaptable</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</code></pre></div>


<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">find_partial_overlaps</span><span class="p">(</span><span class="k">host</span><span class="p">,</span> <span class="n">parasite</span><span class="p">,</span> <span class="n">swaptable</span><span class="p">,</span> <span class="k">verbose</span><span class="o">=</span><span class="k">True</span><span class="p">):</span>

    <span class="n">flank</span> <span class="o">=</span> <span class="n">len</span><span class="p">(</span><span class="n">parasite</span><span class="p">)</span> <span class="o">*</span> <span class="ss">&quot;N&quot;</span>

    <span class="n">host_flank</span> <span class="o">=</span> <span class="n">flank</span> <span class="o">+</span> <span class="k">host</span> <span class="o">+</span> <span class="n">flank</span>

    <span class="n">swaptable</span><span class="p">[</span><span class="ss">&quot;NNN&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="ss">&quot;NNN&quot;</span><span class="p">,)</span>

    <span class="k">result</span> <span class="o">=</span> <span class="n">make_genealloy</span><span class="p">(</span><span class="n">host_flank</span><span class="p">,</span> <span class="n">parasite</span><span class="p">,</span> <span class="n">swaptable</span><span class="p">,</span> <span class="k">verbose</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="k">result</span>
</code></pre></div>


</details>
<h3 id="get_complement_tuplelist">get_complement_tuplelist</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_complement_tuplelist</span><span class="p">(</span>
    <span class="n">codon_tuplelist</span>
<span class="p">)</span>
</code></pre></div>


<p>Get complement triplets of a sequence tuplelist.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">get_complement_tuplelist</span><span class="p">(</span><span class="n">codon_tuplelist</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot;Get complement triplets of a sequence tuplelist.&quot;&quot;&quot;</span><span class="w"></span>

<span class="w">    </span><span class="n">complement_tuplelist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[]</span><span class="w"></span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="k">index</span><span class="p">,</span><span class="w"> </span><span class="n">codon</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">codon_tuplelist</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="n">complement_tripletlist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[]</span><span class="w"></span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">triplet</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">codon</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">letter1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">triplet</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="w"></span>

<span class="w">            </span><span class="n">letter2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">triplet</span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="w"></span>

<span class="w">            </span><span class="n">letter3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">triplet</span><span class="o">[</span><span class="n">2</span><span class="o">]</span><span class="w"></span>

<span class="w">            </span><span class="n">complement_triplet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"></span>

<span class="w">                </span><span class="n">complement_table</span><span class="o">[</span><span class="n">letter1</span><span class="o">]</span><span class="w"></span>

<span class="w">                </span><span class="o">+</span><span class="w"> </span><span class="n">complement_table</span><span class="o">[</span><span class="n">letter2</span><span class="o">]</span><span class="w"></span>

<span class="w">                </span><span class="o">+</span><span class="w"> </span><span class="n">complement_table</span><span class="o">[</span><span class="n">letter3</span><span class="o">]</span><span class="w"></span>

<span class="w">            </span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">complement_tripletlist</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">complement_triplet</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">complement_codon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tuple</span><span class="p">(</span><span class="n">complement_tripletlist</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">complement_tuplelist</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">complement_codon</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">complement_tuplelist</span><span class="w"></span>
</code></pre></div>


</details>
<h3 id="get_letter_in_next_triplet">get_letter_in_next_triplet</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_letter_in_next_triplet</span><span class="p">(</span>
    <span class="n">sequence_tuplelist</span><span class="p">,</span>
    <span class="n">current_letter_index</span>
<span class="p">)</span>
</code></pre></div>


<p>Get first letter in the next triplet.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">get_letter_in_next_triplet</span><span class="p">(</span><span class="n">sequence_tuplelist</span><span class="p">,</span><span class="w"> </span><span class="n">current_letter_index</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot;Get first letter in the next triplet.&quot;&quot;&quot;</span><span class="w"></span>

<span class="w">    </span><span class="n">letter_index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">current_letter_index</span><span class="w"></span>

<span class="w">    </span><span class="n">letter_index</span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">letter_index</span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="n">triplet</span><span class="w"> </span><span class="k">position</span><span class="w"></span>

<span class="w">    </span><span class="n">letter_index</span><span class="o">[</span><span class="n">2</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="n">move</span><span class="w"> </span><span class="n">letter</span><span class="w"> </span><span class="k">position</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">triplet</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="k">first</span><span class="w"> </span><span class="n">letter</span><span class="w"></span>

<span class="w">    </span><span class="k">try</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">letter_index</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">letter_index</span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">letter_index</span><span class="o">[</span><span class="n">2</span><span class="o">]</span><span class="w"></span>

<span class="w">        </span><span class="n">letter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">sequence_tuplelist</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">][</span><span class="n">k</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">letter_index</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">letter</span><span class="w"></span>

<span class="w">    </span><span class="ow">except</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="n">raise</span><span class="w"></span>
</code></pre></div>


</details>
<h3 id="get_next_letter">get_next_letter</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_next_letter</span><span class="p">(</span>
    <span class="n">sequence_tuplelist</span><span class="p">,</span>
    <span class="n">current_letter_index</span>
<span class="p">)</span>
</code></pre></div>


<p>Get next letter in the sequence.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">get_next_letter</span><span class="p">(</span><span class="n">sequence_tuplelist</span><span class="p">,</span><span class="w"> </span><span class="n">current_letter_index</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot;Get next letter in the sequence.&quot;&quot;&quot;</span><span class="w"></span>

<span class="w">    </span><span class="n">letter_index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">current_letter_index</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">current_letter_index</span><span class="o">[</span><span class="n">2</span><span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="k">last</span><span class="w"> </span><span class="n">letter</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">triplet</span><span class="p">,</span><span class="w"> </span><span class="n">advance</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">next</span><span class="w"> </span><span class="nl">codon</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="n">letter_index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">letter_index[0</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="err">]</span><span class="w"></span>

<span class="w">        </span><span class="k">try</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">letter_index</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">letter_index</span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">letter_index</span><span class="o">[</span><span class="n">2</span><span class="o">]</span><span class="w"></span>

<span class="w">            </span><span class="n">letter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">sequence_tuplelist</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">][</span><span class="n">k</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">letter_index</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">letter</span><span class="w"></span>

<span class="w">        </span><span class="ow">except</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">raise</span><span class="w"></span>

<span class="w">    </span><span class="k">else</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">letter</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">last</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">triplet</span><span class="p">,</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">next</span><span class="w"> </span><span class="nl">one</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="n">letter_index</span><span class="o">[</span><span class="n">2</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">letter_index</span><span class="o">[</span><span class="n">2</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>

<span class="w">        </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">letter_index</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">letter_index</span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">letter_index</span><span class="o">[</span><span class="n">2</span><span class="o">]</span><span class="w"></span>

<span class="w">        </span><span class="n">letter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">sequence_tuplelist</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">][</span><span class="n">k</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">letter_index</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">letter</span><span class="w"></span>
</code></pre></div>


</details>
<h3 id="get_reverse_complement_tuplelist">get_reverse_complement_tuplelist</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_reverse_complement_tuplelist</span><span class="p">(</span>
    <span class="n">codon_tuplelist</span>
<span class="p">)</span>
</code></pre></div>


<p>Get reverse complement of a sequence's tuplelist.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">get_reverse_complement_tuplelist</span><span class="p">(</span><span class="n">codon_tuplelist</span><span class="p">):</span>

    <span class="ss">&quot;&quot;&quot;Get reverse complement of a sequence&#39;s tuplelist.&quot;&quot;&quot;</span>

    <span class="n">complement_tuplelist</span> <span class="o">=</span> <span class="n">get_complement_tuplelist</span><span class="p">(</span><span class="n">codon_tuplelist</span><span class="p">)</span>

    <span class="n">reverse_complement_tuplelist</span> <span class="o">=</span> <span class="n">get_reverse_tuplelist</span><span class="p">(</span><span class="n">complement_tuplelist</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">reverse_complement_tuplelist</span>
</code></pre></div>


</details>
<h3 id="get_reverse_tuplelist">get_reverse_tuplelist</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_reverse_tuplelist</span><span class="p">(</span>
    <span class="n">codon_tuplelist</span>
<span class="p">)</span>
</code></pre></div>


<p>Get reverse of a tuplelist with reversed triplets.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="s s-Atom">def</span> <span class="nf">get_reverse_tuplelist</span><span class="p">(</span><span class="s s-Atom">codon_tuplelist</span><span class="p">)</span><span class="s s-Atom">:</span>

    <span class="s2">&quot;&quot;&quot;Get reverse of a tuplelist with reversed triplets.&quot;&quot;&quot;</span>

    <span class="s s-Atom">reverse_tuplelist</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="s s-Atom">for</span> <span class="s s-Atom">codon</span> <span class="s s-Atom">in</span> <span class="nf">reversed</span><span class="p">(</span><span class="s s-Atom">codon_tuplelist</span><span class="p">)</span><span class="s s-Atom">:</span>

        <span class="s s-Atom">reverse_tripletlist</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="s s-Atom">for</span> <span class="s s-Atom">triplet</span> <span class="s s-Atom">in</span> <span class="nn">codon</span><span class="p">:</span>

            <span class="s s-Atom">reverse_triplet</span> <span class="o">=</span> <span class="s s-Atom">triplet</span><span class="p">[</span><span class="s s-Atom">::-</span><span class="mi">1</span><span class="p">]</span>

            <span class="s s-Atom">reverse_tripletlist</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="s s-Atom">reverse_triplet</span><span class="p">)</span>

        <span class="s s-Atom">reverse_codon</span> <span class="o">=</span> <span class="nf">tuple</span><span class="p">(</span><span class="s s-Atom">reverse_tripletlist</span><span class="p">)</span>

        <span class="s s-Atom">reverse_tuplelist</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="s s-Atom">reverse_codon</span><span class="p">)</span>

    <span class="s s-Atom">return</span> <span class="s s-Atom">reverse_tuplelist</span>
</code></pre></div>


</details>
<h3 id="make_genealloy">make_genealloy</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">make_genealloy</span><span class="p">(</span>
    <span class="n">host</span><span class="p">,</span>
    <span class="n">parasite</span><span class="p">,</span>
    <span class="n">swaptable</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</code></pre></div>


<p>Compare two sequence strings and return dictionary of matches.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">make_genealloy</span><span class="p">(</span><span class="k">host</span><span class="p">,</span> <span class="n">parasite</span><span class="p">,</span> <span class="n">swaptable</span><span class="p">,</span> <span class="k">verbose</span><span class="o">=</span><span class="k">True</span><span class="p">):</span>

    <span class="ss">&quot;&quot;&quot;Compare two sequence strings and return dictionary of matches.&quot;&quot;&quot;</span>

    <span class="n">host_codons</span> <span class="o">=</span> <span class="n">convert_seq_to_codons</span><span class="p">(</span><span class="k">host</span><span class="p">)</span>

    <span class="n">host_tuplelist</span> <span class="o">=</span> <span class="n">convert_codonlist_to_tuplelist</span><span class="p">(</span><span class="n">host_codons</span><span class="p">,</span> <span class="n">swaptable</span><span class="p">)</span>

    <span class="n">parasite_codons</span> <span class="o">=</span> <span class="n">convert_seq_to_codons</span><span class="p">(</span><span class="n">parasite</span><span class="p">)</span>

    <span class="n">parasite_tuplelist</span> <span class="o">=</span> <span class="n">convert_codonlist_to_tuplelist</span><span class="p">(</span><span class="n">parasite_codons</span><span class="p">,</span> <span class="n">swaptable</span><span class="p">)</span>

    <span class="n">forward_results</span> <span class="o">=</span> <span class="n">compare_sequence_tuplelists_in_all_frames</span><span class="p">(</span>

        <span class="n">parasite_tuplelist</span><span class="p">,</span> <span class="n">host_tuplelist</span><span class="p">,</span> <span class="k">prefix</span><span class="o">=</span><span class="ss">&quot;f_&quot;</span>

    <span class="p">)</span>

    <span class="n">reverse_complement_tuplelist</span> <span class="o">=</span> <span class="n">get_reverse_complement_tuplelist</span><span class="p">(</span><span class="n">host_tuplelist</span><span class="p">)</span>

    <span class="n">reverse_complement_results</span> <span class="o">=</span> <span class="n">compare_sequence_tuplelists_in_all_frames</span><span class="p">(</span>

        <span class="n">parasite_tuplelist</span><span class="p">,</span> <span class="n">reverse_complement_tuplelist</span><span class="p">,</span> <span class="k">prefix</span><span class="o">=</span><span class="ss">&quot;rc_&quot;</span>

    <span class="p">)</span>

    <span class="k">result</span> <span class="o">=</span> <span class="n">forward_results</span><span class="p">.</span><span class="k">copy</span><span class="p">()</span>

    <span class="k">result</span><span class="p">.</span><span class="k">update</span><span class="p">(</span><span class="n">reverse_complement_results</span><span class="p">)</span>

    <span class="k">if</span> <span class="k">verbose</span><span class="p">:</span>

        <span class="k">if</span> <span class="k">all</span><span class="p">(</span><span class="n">value</span> <span class="o">==</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">value</span> <span class="k">in</span> <span class="k">result</span><span class="p">.</span><span class="k">values</span><span class="p">()):</span>

            <span class="n">print</span><span class="p">(</span><span class="ss">&quot;These sequences cannot be mixed&quot;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="n">print</span><span class="p">(</span><span class="ss">&quot;A genealloy can be made using these sequences!&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="k">result</span>
</code></pre></div>


</details>
<h3 id="walk_seqstep">walk_seqstep</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">walk_seqstep</span><span class="p">(</span>
    <span class="n">seqstep</span>
<span class="p">)</span>
</code></pre></div>


<p>Compare two sequences by calling <code>advance_step</code> until it returns the result.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="nf">walk_seqstep</span><span class="p">(</span><span class="n">seqstep</span><span class="p">):</span>

    <span class="s2">&quot;&quot;&quot;Compare two sequences by calling `advance_step` until it returns the result.&quot;&quot;&quot;</span>

    <span class="k">while</span> <span class="k">not</span> <span class="n">seqstep</span><span class="p">.</span><span class="n">result</span><span class="p">:</span>

        <span class="n">seqstep</span><span class="p">.</span><span class="nf">advance_step</span><span class="p">()</span>
</code></pre></div>


</details>
<h2 id="classes">Classes</h2>
<h3 id="duodon">Duodon</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Duodon</span><span class="p">(</span>
    <span class="n">first_triplet</span><span class="p">,</span>
    <span class="n">second_triplet</span>
<span class="p">)</span>
</code></pre></div>


<p>Class for storing two triplets</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="n">Duodon:</span>

    <span class="s">&quot;&quot;&quot;Class for storing two triplets&quot;&quot;&quot;</span>

    <span class="n">def</span> <span class="n">__init__</span>(<span class="nb">self</span>, <span class="n">first_triplet</span>, <span class="n">second_triplet</span>):

        <span class="nb">self</span>.<span class="n">first_triplet</span> = <span class="n">first_triplet</span>

        <span class="nb">self</span>.<span class="n">second_triplet</span> = <span class="n">second_triplet</span>
</code></pre></div>


</details>
<hr />
<h3 id="seqstep">SeqStep</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">SeqStep</span><span class="p">(</span>
    <span class="n">host_tuplelist</span><span class="p">,</span>
    <span class="n">parasite_tuplelist</span><span class="p">,</span>
    <span class="n">frameshift</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">start_host_codon</span><span class="o">=</span><span class="mi">0</span>
<span class="p">)</span>
</code></pre></div>


<p>Class for keeping track of sequence comparison</p>
<p>It stores a method that aligns a parasite triplet with two consecutive host
triplets (duodons), a cursor that marks the position of the comparison process,
and methods for generating duodons and comparing them with triplets.
The <code>advance_step()</code> method attempts to advance the comparison by one codon
step. It can (i) advance the cursor or (ii) conclude that there is no match
between the sequences, or (iii) conclude that there is a match.</p>
<h2 id="parameters">Parameters</h2>
<p>host_tuplelist
  A list of tuples. Each tuple stores the allowed triplets for a codon
  position of the host sequence.</p>
<p>parasite_tuplelist
  A list of tuples. Each tuple stores the allowed triplets for a codon
  position of the parasite sequence.</p>
<p>frameshift
  An integer (0, 1 or 2) denoting the frameshift between host and parasite.</p>
<p>start_host_codon
  The host codon position from which the comparison should start.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nl">SeqStep</span><span class="p">:</span><span class="w"></span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot;Class for keeping track of sequence comparison</span>

<span class="ss">    It stores a method that aligns a parasite triplet with two consecutive host</span>

<span class="ss">    triplets (duodons), a cursor that marks the position of the comparison process,</span>

<span class="ss">    and methods for generating duodons and comparing them with triplets.</span>

<span class="ss">    The `advance_step()` method attempts to advance the comparison by one codon</span>

<span class="ss">    step. It can (i) advance the cursor or (ii) conclude that there is no match</span>

<span class="ss">    between the sequences, or (iii) conclude that there is a match.</span>

<span class="ss">    Parameters</span>

<span class="ss">    ----------</span>

<span class="ss">    host_tuplelist</span>

<span class="ss">      A list of tuples. Each tuple stores the allowed triplets for a codon</span>

<span class="ss">      position of the host sequence.</span>

<span class="ss">    parasite_tuplelist</span>

<span class="ss">      A list of tuples. Each tuple stores the allowed triplets for a codon</span>

<span class="ss">      position of the parasite sequence.</span>

<span class="ss">    frameshift</span>

<span class="ss">      An integer (0, 1 or 2) denoting the frameshift between host and parasite.</span>

<span class="ss">    start_host_codon</span>

<span class="ss">      The host codon position from which the comparison should start.</span>

<span class="ss">    &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__init__</span><span class="p">(</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">host_tuplelist</span><span class="p">,</span><span class="w"> </span><span class="n">parasite_tuplelist</span><span class="p">,</span><span class="w"> </span><span class="n">frameshift</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">start_host_codon</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>

<span class="w">    </span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">host_tuplelist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">host_tuplelist</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">parasite_tuplelist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parasite_tuplelist</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">frameshift</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">frameshift</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">start_host_codon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_host_codon</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="nc">cursor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">len_parasite</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">parasite_tuplelist</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">len_host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">host_tuplelist</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">parasite_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[]</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">host_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[]</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="k">match</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">False</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="k">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">generate_duodons</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="nc">cursor</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">start_host_codon</span><span class="w"></span>

<span class="w">        </span><span class="n">duodons</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[]</span><span class="w"></span>

<span class="w">        </span><span class="n">host_codon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">start_host_codon</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nc">cursor</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">host_path</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="err">[]:</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="k">first</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="n">it</span><span class="s1">&#39;s made</span>

<span class="s1">            for triplet_1 in self.host_tuplelist[host_codon]:</span>

<span class="s1">                for triplet_2 in self.host_tuplelist[host_codon + 1]:</span>

<span class="s1">                    duodons.append(Duodon(triplet_1, triplet_2))</span>

<span class="s1">        else:</span>

<span class="s1">            triplet_1 = self.host_path[-1].second_triplet  # of last used duodon</span>

<span class="s1">            try:</span>

<span class="s1">                for triplet_2 in self.host_tuplelist[host_codon + 1]:</span>

<span class="s1">                    duodons.append(Duodon(triplet_1, triplet_2))</span>

<span class="s1">            except:</span>

<span class="s1">                duodons.append(Duodon(triplet_1, &quot;NNN&quot;))</span>

<span class="s1">        return duodons</span>

<span class="s1">    def return_all_matching_duodons(self, triplet, duodons, frameshift=0):</span>

<span class="s1">        matching_duodons = []</span>

<span class="s1">        for duodon in duodons:</span>

<span class="s1">            host_letters = duodon.first_triplet + duodon.second_triplet</span>

<span class="s1">            # compare 1st letter:</span>

<span class="s1">            if not compare_letters(host_letters[0 + frameshift], triplet[0]):</span>

<span class="s1">                continue</span>

<span class="s1">            if not compare_letters(host_letters[1 + frameshift], triplet[1]):</span>

<span class="s1">                continue</span>

<span class="s1">            if not compare_letters(host_letters[2 + frameshift], triplet[2]):</span>

<span class="s1">                continue</span>

<span class="s1">            matching_duodons.append(duodon)</span>

<span class="s1">        return matching_duodons</span>

<span class="s1">    def compare_triplet_and_duodon(self, triplet, duodon, frameshift=0):</span>

<span class="s1">        host_letters = duodon.first_triplet + duodon.second_triplet</span>

<span class="s1">        if not compare_letters(host_letters[0 + frameshift], triplet[0]):</span>

<span class="s1">            return False</span>

<span class="s1">        if not compare_letters(host_letters[1 + frameshift], triplet[1]):</span>

<span class="s1">            return False</span>

<span class="s1">        if not compare_letters(host_letters[2 + frameshift], triplet[2]):</span>

<span class="s1">            return False</span>

<span class="s1">        return True</span>

<span class="s1">    def advance_step(self):</span>

<span class="s1">        if self.result:</span>

<span class="s1">            return self.result</span>

<span class="s1">        if self.cursor == self.len_parasite:</span>

<span class="s1">            self.match = True</span>

<span class="s1">            self.result = (</span>

<span class="s1">                &quot;Match found between parasite and host sequence. Start codon was: &quot;</span>

<span class="s1">                + str(self.start_host_codon)</span>

<span class="s1">            )</span>

<span class="s1">            return self.result</span>

<span class="s1">        parasite_triplets = list(self.parasite_tuplelist[self.cursor])</span>

<span class="s1">        host_duodons = self.generate_duodons()</span>

<span class="s1">        while True:</span>

<span class="s1">            try:</span>

<span class="s1">                parasite_triplet = parasite_triplets[0]</span>

<span class="s1">            except:</span>

<span class="s1">                self.result = &quot;Sequences don&#39;</span><span class="n">t</span><span class="w"> </span><span class="k">match</span><span class="p">.</span><span class="w"> </span><span class="k">Start</span><span class="w"> </span><span class="n">codon</span><span class="w"> </span><span class="nl">was</span><span class="p">:</span><span class="w"> </span><span class="ss">&quot; + str(</span>

<span class="ss">                    self.start_host_codon</span>

<span class="ss">                )</span>

<span class="ss">                return self.result</span>

<span class="ss">            else:</span>

<span class="ss">                host_duodons_for_parasite_triplet = host_duodons[:]</span>

<span class="ss">                host_duodons_for_parasite_triplet = self.return_all_matching_duodons(</span>

<span class="ss">                    parasite_triplet,</span>

<span class="ss">                    host_duodons_for_parasite_triplet,</span>

<span class="ss">                    frameshift=self.frameshift,</span>

<span class="ss">                )</span>

<span class="ss">                self.parasite_path.append(parasite_triplet)</span>

<span class="ss">                while True:</span>

<span class="ss">                    try:</span>

<span class="ss">                        host_doudon = host_duodons_for_parasite_triplet[0]</span>

<span class="ss">                    except:</span>

<span class="ss">                        self.parasite_path.pop()</span>

<span class="ss">                        del parasite_triplets[0]</span>

<span class="ss">                        break</span>

<span class="ss">                    else:</span>

<span class="ss">                        if self.compare_triplet_and_duodon(</span>

<span class="ss">                            parasite_triplet, host_doudon, frameshift=self.frameshift</span>

<span class="ss">                        ):</span>

<span class="ss">                            self.host_path.append(host_doudon)</span>

<span class="ss">                            self.cursor += 1</span>

<span class="ss">                            return &quot;</span><span class="n">Codon</span><span class="w"> </span><span class="n">matched</span><span class="p">,</span><span class="w"> </span><span class="nc">cursor</span><span class="w"> </span><span class="n">advanced</span><span class="err">&quot;</span><span class="w"></span>

<span class="w">                        </span><span class="k">else</span><span class="err">:</span><span class="w"></span>

<span class="w">                            </span><span class="n">del</span><span class="w"> </span><span class="n">host_duodons_for_parasite_triplet</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="w"></span>
</code></pre></div>


</details>
<hr />
<h4 id="methods">Methods</h4>
<h5 id="advance_step">advance_step</h5>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">advance_step</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>


<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="n">advance_step</span><span class="p">(</span><span class="k">self</span><span class="p">):</span>

        <span class="k">if</span> <span class="k">self</span><span class="p">.</span><span class="k">result</span><span class="p">:</span>

            <span class="k">return</span> <span class="k">self</span><span class="p">.</span><span class="k">result</span>

        <span class="k">if</span> <span class="k">self</span><span class="p">.</span><span class="k">cursor</span> <span class="o">==</span> <span class="k">self</span><span class="p">.</span><span class="n">len_parasite</span><span class="p">:</span>

            <span class="k">self</span><span class="p">.</span><span class="k">match</span> <span class="o">=</span> <span class="k">True</span>

            <span class="k">self</span><span class="p">.</span><span class="k">result</span> <span class="o">=</span> <span class="p">(</span>

                <span class="ss">&quot;Match found between parasite and host sequence. Start codon was: &quot;</span>

                <span class="o">+</span> <span class="n">str</span><span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">start_host_codon</span><span class="p">)</span>

            <span class="p">)</span>

            <span class="k">return</span> <span class="k">self</span><span class="p">.</span><span class="k">result</span>

        <span class="n">parasite_triplets</span> <span class="o">=</span> <span class="n">list</span><span class="p">(</span><span class="k">self</span><span class="p">.</span><span class="n">parasite_tuplelist</span><span class="p">[</span><span class="k">self</span><span class="p">.</span><span class="k">cursor</span><span class="p">])</span>

        <span class="n">host_duodons</span> <span class="o">=</span> <span class="k">self</span><span class="p">.</span><span class="n">generate_duodons</span><span class="p">()</span>

        <span class="n">while</span> <span class="k">True</span><span class="p">:</span>

            <span class="n">try</span><span class="p">:</span>

                <span class="n">parasite_triplet</span> <span class="o">=</span> <span class="n">parasite_triplets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">except</span><span class="p">:</span>

                <span class="k">self</span><span class="p">.</span><span class="k">result</span> <span class="o">=</span> <span class="ss">&quot;Sequences don&#39;t match. Start codon was: &quot;</span> <span class="o">+</span> <span class="n">str</span><span class="p">(</span>

                    <span class="k">self</span><span class="p">.</span><span class="n">start_host_codon</span>

                <span class="p">)</span>

                <span class="k">return</span> <span class="k">self</span><span class="p">.</span><span class="k">result</span>

            <span class="k">else</span><span class="p">:</span>

                <span class="n">host_duodons_for_parasite_triplet</span> <span class="o">=</span> <span class="n">host_duodons</span><span class="p">[:]</span>

                <span class="n">host_duodons_for_parasite_triplet</span> <span class="o">=</span> <span class="k">self</span><span class="p">.</span><span class="n">return_all_matching_duodons</span><span class="p">(</span>

                    <span class="n">parasite_triplet</span><span class="p">,</span>

                    <span class="n">host_duodons_for_parasite_triplet</span><span class="p">,</span>

                    <span class="n">frameshift</span><span class="o">=</span><span class="k">self</span><span class="p">.</span><span class="n">frameshift</span><span class="p">,</span>

                <span class="p">)</span>

                <span class="k">self</span><span class="p">.</span><span class="n">parasite_path</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">parasite_triplet</span><span class="p">)</span>

                <span class="n">while</span> <span class="k">True</span><span class="p">:</span>

                    <span class="n">try</span><span class="p">:</span>

                        <span class="n">host_doudon</span> <span class="o">=</span> <span class="n">host_duodons_for_parasite_triplet</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                    <span class="k">except</span><span class="p">:</span>

                        <span class="k">self</span><span class="p">.</span><span class="n">parasite_path</span><span class="p">.</span><span class="n">pop</span><span class="p">()</span>

                        <span class="n">del</span> <span class="n">parasite_triplets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                        <span class="n">break</span>

                    <span class="k">else</span><span class="p">:</span>

                        <span class="k">if</span> <span class="k">self</span><span class="p">.</span><span class="n">compare_triplet_and_duodon</span><span class="p">(</span>

                            <span class="n">parasite_triplet</span><span class="p">,</span> <span class="n">host_doudon</span><span class="p">,</span> <span class="n">frameshift</span><span class="o">=</span><span class="k">self</span><span class="p">.</span><span class="n">frameshift</span>

                        <span class="p">):</span>

                            <span class="k">self</span><span class="p">.</span><span class="n">host_path</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">host_doudon</span><span class="p">)</span>

                            <span class="k">self</span><span class="p">.</span><span class="k">cursor</span> <span class="o">+=</span> <span class="mi">1</span>

                            <span class="k">return</span> <span class="ss">&quot;Codon matched, cursor advanced&quot;</span>

                        <span class="k">else</span><span class="p">:</span>

                            <span class="n">del</span> <span class="n">host_duodons_for_parasite_triplet</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div>


</details>
<h5 id="compare_triplet_and_duodon">compare_triplet_and_duodon</h5>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">compare_triplet_and_duodon</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">triplet</span><span class="p">,</span>
    <span class="n">duodon</span><span class="p">,</span>
    <span class="n">frameshift</span><span class="o">=</span><span class="mi">0</span>
<span class="p">)</span>
</code></pre></div>


<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="n">compare_triplet_and_duodon</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="n">triplet</span><span class="p">,</span> <span class="n">duodon</span><span class="p">,</span> <span class="n">frameshift</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>

        <span class="n">host_letters</span> <span class="o">=</span> <span class="n">duodon</span><span class="p">.</span><span class="n">first_triplet</span> <span class="o">+</span> <span class="n">duodon</span><span class="p">.</span><span class="n">second_triplet</span>

        <span class="k">if</span> <span class="k">not</span> <span class="n">compare_letters</span><span class="p">(</span><span class="n">host_letters</span><span class="p">[</span><span class="mi">0</span> <span class="o">+</span> <span class="n">frameshift</span><span class="p">],</span> <span class="n">triplet</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>

            <span class="k">return</span> <span class="k">False</span>

        <span class="k">if</span> <span class="k">not</span> <span class="n">compare_letters</span><span class="p">(</span><span class="n">host_letters</span><span class="p">[</span><span class="mi">1</span> <span class="o">+</span> <span class="n">frameshift</span><span class="p">],</span> <span class="n">triplet</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>

            <span class="k">return</span> <span class="k">False</span>

        <span class="k">if</span> <span class="k">not</span> <span class="n">compare_letters</span><span class="p">(</span><span class="n">host_letters</span><span class="p">[</span><span class="mi">2</span> <span class="o">+</span> <span class="n">frameshift</span><span class="p">],</span> <span class="n">triplet</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>

            <span class="k">return</span> <span class="k">False</span>

        <span class="k">return</span> <span class="k">True</span>
</code></pre></div>


</details>
<h5 id="generate_duodons">generate_duodons</h5>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">generate_duodons</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>


<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">generate_duodons</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="nc">cursor</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">start_host_codon</span><span class="w"></span>

<span class="w">        </span><span class="n">duodons</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[]</span><span class="w"></span>

<span class="w">        </span><span class="n">host_codon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">start_host_codon</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nc">cursor</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">host_path</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="err">[]:</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="k">first</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="n">it</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">made</span><span class="w"></span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">triplet_1</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">host_tuplelist</span><span class="o">[</span><span class="n">host_codon</span><span class="o">]</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="n">triplet_2</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">host_tuplelist</span><span class="o">[</span><span class="n">host_codon + 1</span><span class="o">]</span><span class="err">:</span><span class="w"></span>

<span class="w">                    </span><span class="n">duodons</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">Duodon</span><span class="p">(</span><span class="n">triplet_1</span><span class="p">,</span><span class="w"> </span><span class="n">triplet_2</span><span class="p">))</span><span class="w"></span>

<span class="w">        </span><span class="k">else</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">triplet_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">host_path</span><span class="o">[</span><span class="n">-1</span><span class="o">]</span><span class="p">.</span><span class="n">second_triplet</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">last</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">duodon</span><span class="w"></span>

<span class="w">            </span><span class="k">try</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="n">triplet_2</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">host_tuplelist</span><span class="o">[</span><span class="n">host_codon + 1</span><span class="o">]</span><span class="err">:</span><span class="w"></span>

<span class="w">                    </span><span class="n">duodons</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">Duodon</span><span class="p">(</span><span class="n">triplet_1</span><span class="p">,</span><span class="w"> </span><span class="n">triplet_2</span><span class="p">))</span><span class="w"></span>

<span class="w">            </span><span class="ow">except</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="n">duodons</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">Duodon</span><span class="p">(</span><span class="n">triplet_1</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;NNN&quot;</span><span class="p">))</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">duodons</span><span class="w"></span>
</code></pre></div>


</details>
<h5 id="return_all_matching_duodons">return_all_matching_duodons</h5>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">return_all_matching_duodons</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">triplet</span><span class="p">,</span>
    <span class="n">duodons</span><span class="p">,</span>
    <span class="n">frameshift</span><span class="o">=</span><span class="mi">0</span>
<span class="p">)</span>
</code></pre></div>


<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="n">return_all_matching_duodons</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="n">triplet</span><span class="p">,</span> <span class="n">duodons</span><span class="p">,</span> <span class="n">frameshift</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>

        <span class="n">matching_duodons</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">duodon</span> <span class="k">in</span> <span class="n">duodons</span><span class="p">:</span>

            <span class="n">host_letters</span> <span class="o">=</span> <span class="n">duodon</span><span class="p">.</span><span class="n">first_triplet</span> <span class="o">+</span> <span class="n">duodon</span><span class="p">.</span><span class="n">second_triplet</span>

            <span class="o">#</span> <span class="n">compare</span> <span class="mi">1</span><span class="n">st</span> <span class="n">letter</span><span class="p">:</span>

            <span class="k">if</span> <span class="k">not</span> <span class="n">compare_letters</span><span class="p">(</span><span class="n">host_letters</span><span class="p">[</span><span class="mi">0</span> <span class="o">+</span> <span class="n">frameshift</span><span class="p">],</span> <span class="n">triplet</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>

                <span class="k">continue</span>

            <span class="k">if</span> <span class="k">not</span> <span class="n">compare_letters</span><span class="p">(</span><span class="n">host_letters</span><span class="p">[</span><span class="mi">1</span> <span class="o">+</span> <span class="n">frameshift</span><span class="p">],</span> <span class="n">triplet</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>

                <span class="k">continue</span>

            <span class="k">if</span> <span class="k">not</span> <span class="n">compare_letters</span><span class="p">(</span><span class="n">host_letters</span><span class="p">[</span><span class="mi">2</span> <span class="o">+</span> <span class="n">frameshift</span><span class="p">],</span> <span class="n">triplet</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>

                <span class="k">continue</span>

            <span class="n">matching_duodons</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">duodon</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">matching_duodons</span>
</code></pre></div>


</details>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../codontable/" title="Codontable" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Codontable
              </span>
            </div>
          </a>
        
        
          <a href="../" title="Index" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Index
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Powered by
        <a href="http://timothycrosley.github.io/portray">portray.</a>
        You too can
        <a href="http://timothycrosley.github.io/portray">
          portray</a>
        your Python project well using automatic documentation.
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/vendor.92ffa368.min.js"></script>
      <script src="../../../assets/javascripts/bundle.5123e3d4.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../../..",
          features: [],
          search: Object.assign({
            worker: "../../../assets/javascripts/worker/search.a68abb33.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>